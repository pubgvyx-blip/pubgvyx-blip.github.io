<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KRAKEN UC SHOP</title>
<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } 
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAdE6pSRtNx9AlEFR2UrFO87_fpFXLg9C4",
  authDomain: "krakenuc-dc537.firebaseapp.com",
  projectId: "krakenuc-dc537",
  storageBucket: "krakenuc-dc537.firebasestorage.app",
  messagingSenderId: "814916661220",
  appId: "1:814916661220:web:1f4a7e050c390f9c27e1f1"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.login = async function(){
  const email = document.getElementById("email").value;
  const pass = document.getElementById("pass").value;
  await signInWithEmailAndPassword(auth,email,pass);
  alert("Вход выполнен");
  loadReviews();
}

window.addReview = async function(){
  const text = document.getElementById("reviewText").value;
  await addDoc(collection(db,"reviews"),{
    text:text,
    user:auth.currentUser.email,
    created:Date.now()
  });
  loadReviews();
}

async function loadReviews(){
  const querySnapshot = await getDocs(collection(db,"reviews"));
  const list = document.getElementById("reviews");
  list.innerHTML="";
  querySnapshot.forEach((docu)=>{
    list.innerHTML+=`
    <div class="review">
      <b>${docu.data().user}</b>
      <p>${docu.data().text}</p>
    </div>`;
  });
}

onAuthStateChanged(auth,(user)=>{
  if(user){
    loadReviews();
  }
});

</script>

<style>
body{
  background:#0f0f1c;
  color:white;
  font-family:sans-serif;
}
.card{
  background:#1b1b2e;
  padding:20px;
  margin:10px;
  border-radius:12px;
}
button{
  background:#ff0055;
  color:white;
  border:none;
  padding:10px;
  border-radius:8px;
  cursor:pointer;
}
.review{
  background:#222;
  padding:10px;
  margin:10px;
  border-radius:10px;
}
</style>
</head>

<body>

<h1>KRAKEN UC SHOP</h1>

<div class="card">
<h3>Вход</h3>
<input id="email" placeholder="email"><br><br>
<input id="pass" type="password" placeholder="пароль"><br><br>
<button onclick="login()">Войти</button>
</div>

<div class="card">
<h3>Добавить отзыв</h3>
<textarea id="reviewText"></textarea><br><br>
<button onclick="addReview()">Отправить</button>
</div>

<div class="card">
<h3>Отзывы</h3>
<div id="reviews"></div>
</div>

<a href="admin.html">Админ-панель</a>

</body>
</html>
